"use strict";(self["webpackChunksixth"]=self["webpackChunksixth"]||[]).push([[518],{1530:function(e,t,a){function l(e){return{all:e=e||new Map,on:function(t,a){var l=e.get(t);l?l.push(a):e.set(t,[a])},off:function(t,a){var l=e.get(t);l&&(a?l.splice(l.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var l=e.get(t);l&&l.slice().map((function(e){e(a)})),(l=e.get("*"))&&l.slice().map((function(e){e(t,a)}))}}}a.d(t,{Z:function(){return i}});const s=l();var i=s},518:function(e,t,a){a.r(t),a.d(t,{default:function(){return K}});var l=a(6252),s=a(9963),i=a(3577);const o=(0,l._)("h2",{class:"text-center py-3"},"購物車",-1),n={class:"container"},r={class:"text-end"},d=(0,l._)("i",{class:"fas fa-spinner fa-pulse"},null,-1),m=[d],c=(0,l.Uk)(" 清空購物車 "),u={class:"table align-middle"},p=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th"),(0,l._)("th",null,"圖片"),(0,l._)("th",null,"商品名稱"),(0,l._)("th",null,"數量/單位"),(0,l._)("th",null,"單價")])],-1),h=["onClick"],f=(0,l._)("i",{class:"fas fa-spinner fa-pulse"},null,-1),g=[f],_=(0,l.Uk)(" x "),b={style:{width:"200px"}},v={class:"input-group input-group-sm"},y={class:"input-group mb-3 w-50"},C=["onUpdate:modelValue","onChange","disabled"],x={class:"input-group-text",id:"basic-addon2"},w=(0,l._)("td",{colspan:"4",class:"text-end"},"總計",-1),k=(0,l._)("h2",{class:"mb-4"},"收件人資料",-1),V={class:"mb-3"},L=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),I={class:"mb-3"},z=(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),U={class:"mb-3"},$=(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),W={class:"mb-3"},D=(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1),q={class:"mb-3"},S=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),A={class:"text-end"};function Z(e,t,a,d,f,Z){const F=(0,l.up)("field-view"),H=(0,l.up)("error-message"),Y=(0,l.up)("form-view");return(0,l.wg)(),(0,l.iD)(l.HY,null,[o,(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>Z.delAllCart&&Z.delAllCart(...e))},[(0,l.wy)((0,l._)("span",null,m,512),[[s.F8,1===f.isLoadingItem]]),c])]),(0,l._)("table",u,[p,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(f.cartData.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.name},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>Z.delCartItem(e.id)},[(0,l.wy)((0,l._)("span",null,g,512),[[s.F8,f.isLoadingItem===e.id]]),_],8,h)]),(0,l._)("td",b,[(0,l._)("div",{style:(0,i.j5)([{backgroundImage:`url(${e.product.imageUrl})`},{height:"100px","background-size":"cover","background-position":"center"}])},null,4)]),(0,l._)("td",null,(0,i.zw)(e.product.title),1),(0,l._)("td",null,[(0,l._)("div",v,[(0,l._)("div",y,[(0,l.wy)((0,l._)("select",{id:"",class:"form-control","onUpdate:modelValue":t=>e.qty=t,onChange:t=>Z.updateCartItem(e),disabled:f.isLoadingItem===e.id},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(20,(e=>(0,l._)("option",{key:e+123},(0,i.zw)(e),1))),64))],40,C),[[s.bM,e.qty]]),(0,l._)("span",x,(0,i.zw)(e.product.unit),1)])])]),(0,l._)("td",null,(0,i.zw)(e.product.price)+"元",1)])))),128))]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[w,(0,l._)("td",null,(0,i.zw)(f.cartData.total)+"元",1)])])]),(0,l._)("div",{class:"d-flex flex-column align-items-center my-4",onSubmit:t[7]||(t[7]=(...e)=>Z.onSubmit&&Z.onSubmit(...e))},[(0,l.Wm)(Y,{ref:"form",class:"col-md-6"},{default:(0,l.w5)((({errors:e})=>[k,(0,l._)("div",V,[L,(0,l.Wm)(F,{id:"email",name:"email",type:"email",class:(0,i.C_)(["form-control",{"is-invalid":e["email"]}]),rules:"email",placeholder:"請輸入 Email",modelValue:f.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>f.form.user.email=e)},null,8,["class","modelValue"]),(0,l.Wm)(H,{name:"email",class:"invalid-feedback text-start"})]),(0,l._)("div",I,[z,(0,l.Wm)(F,{id:"name",name:"姓名",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:f.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>f.form.user.name=e)},null,8,["class","modelValue"]),(0,l.Wm)(H,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",U,[$,(0,l.Wm)(F,{id:"tel",name:"電話",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:Z.isPhone,modelValue:f.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>f.form.user.tel=e)},null,8,["class","rules","modelValue"]),(0,l.Wm)(H,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",W,[D,(0,l.Wm)(F,{id:"address",name:"地址",type:"text",class:(0,i.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:f.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>f.form.user.address=e)},null,8,["class","modelValue"]),(0,l.Wm)(H,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",q,[S,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=e=>f.form.message=e)},null,512),[[s.nr,f.form.message]])]),(0,l._)("div",A,[(0,l._)("button",{type:"submit",class:"btn btn-primary",onClick:t[6]||(t[6]=(...e)=>Z.onSubmit&&Z.onSubmit(...e))},"送出訂單")])])),_:1},512)],32)])],64)}var F=a(1530),H={data(){return{cartData:{},isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{getCartList(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/zy123/cart").then((e=>{this.cartData=e.data.data})).catch((e=>{console.log(e)}))},updateCartItem(e){this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/zy123/cart/${e.id}`,{data:{product_id:e.id,qty:Number(e.qty)}}).then((e=>{this.getCartList(),alert(e.data.message)})).catch((e=>{alert(e.data.message)}))},delCartItem(e){this.isLoadingItem=e,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/zy123/cart/${e}`).then((e=>{this.getCartList(),F.Z.emit("get-cart-list"),this.isLoadingItem="",alert(e.data.message)})).catch((e=>{alert(e.data.message)}))},delAllCart(){this.isLoadingItem=1,this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/zy123/carts").then((e=>{this.isLoadingItem=0,this.getCartList(),F.Z.emit("get-cart-list"),alert(e.data.message)})).catch((e=>{alert(e.data.message)}))},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"},onSubmit(){this.$http.post("https://vue3-course-api.hexschool.io/v2/api/zy123/order",{data:this.form}).then((e=>{console.log(e),alert(e.data.message),this.getCartList(),this.$refs.form.resetForm(),this.form.message="",this.delAllCart()})).catch((e=>{console.log(e),alert(e.data.message)}))}},mounted(){this.getCartList()}},Y=a(3744);const E=(0,Y.Z)(H,[["render",Z]]);var K=E}}]);
//# sourceMappingURL=518.a9f0630f.js.map